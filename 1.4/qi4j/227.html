<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
   <head>
      <title>UnitOfWork    - www.qi4j.org</title>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <meta http-equiv="imagetoolbar" content="no" />
      <meta name="DC.Identifier" scheme="URL" content="http://www.qi4j.org" />
      <meta name="DC.Language" scheme="RFC1766" content="en" />
      <meta name="DC.Format" scheme="IMT" content="text/html" />
      <meta name="DC.Type" content="text" />
      <link rel="schema.DC" href="http://purl.org/DC/elements/1.0/" />
      <style type="text/css" media="braille,embossed,handheld,print,projection,screen,speech,tty,tv">
         @import url(../2.6f43db4e123f11b40958000145/0/1964/print/SiteVision.css);
         @import url(../2.6f43db4e123f11b40958000145/auto-1-126/1964/SiteVision.css);
      </style>
      <!--[if IE]><link rel="stylesheet" type="text/css" media="screen" href="/sitevision-ie.css" /><![endif]-->
      <link rel="stylesheet" type="text/css" media="screen" href="../sitevision/ajax/jquery/plugins/fancybox/jquery.fancybox-1.3.1-mod.css" />
      <!--[if IE]><link rel="stylesheet" type="text/css" media="screen" href="/sitevision/ajax/jquery/plugins/fancybox/jquery.fancybox-1.3.1-ie.css" /><![endif]-->
      <link rel="stylesheet" type="text/css" media="screen" href="../sitevision/ajax/jquery/plugins/rating/jquery.rating.css" />
      <script type="text/javascript" src="../sitevision/util/externallinks.js"></script>
      <script type="text/javascript" src="../sitevision/ajax/jquery/jquery-1.4.2.min.js"></script>
      <script type="text/javascript" src="../sitevision/ajax/jquery/plugins/rating/jquery.rating.js"></script>
      <script type="text/javascript" src="../sitevision/ajax/jquery/plugins/metadata/jquery.metadata.min.js"></script>
      <script type="text/javascript">
         var $svjq = jQuery.noConflict();
      </script>
      <script type="text/javascript" src="../sitevision/ajax/jquery/plugins/pngfix/jquery.pngFix.pack.js"></script>
      <script type="text/javascript" src="../sitevision/ajax/jquery/plugins/fancybox/jquery.fancybox-1.3.1.pack.js"></script>
   </head>

   <body class="c0">



<div  id="svid10_6f43db4e123f11b409580001291"><div class="c1" id="svid10_6f43db4e123f11b409580002977">
<div class="c2" id="svid10_6f43db4e123f11b409580004453">
<div id="svid10_6f43db4e123f11b409580004781">
<div class="c3" id="svid12_6f43db4e123f11b409580001845"><div id="Qi4jlogo"><!-- Qi4j logo --></div><a title="Return to Qi4j homepage" href="2.html"><img alt="Qi4j" class="c4" src="../images/18.6f43db4e123f11b409580003681/logo-box.jpg" /></a></div>
<div class="c5" id="svid12_6f43db4e123f11b409580004581"><div id="Multilevellink1"><!-- Multilevellink 1 --></div>

<ul class="c6">
  <li  class="breadcrumb c7">      
          
        <a href="2.html" title="" class="breadcrumb c8" >Home</a>
    </li>
  <li  class="breadcrumb c7"> <img alt="" src="../images/18.6f43db4e123f11b409580002965/breadcrumb.gif" class="c48" />       
          
        <a href="333.html" title="" class="breadcrumb c48" >Sandbox</a>
    </li>
  <li  class="breadcrumb c7"> <img alt="" src="../images/18.6f43db4e123f11b409580002965/breadcrumb.gif" class="c48" />       
          
        <a href="334.html" title="" class="breadcrumb c48" >Libraries</a>
    </li>
  <li  class="breadcrumb c7"> <img alt="" src="../images/18.6f43db4e123f11b409580002965/breadcrumb.gif" class="c48" />         <span class="c48" >UnitOfWork</span>
    </li>
</ul>
</div>
<div class="c9" id="svid12_6f43db4e123f11b409580004814"><div id="Search"><!-- Search --></div><form method="get" action="158.html" class="c19">
   <div>
      <label for="search12_6f43db4e123f11b409580004814" class="svhidden">Search</label>
      <input id="search12_6f43db4e123f11b409580004814" class="search c8"  type="text" name="query" size="20" value="Search here" onclick="if (this.value = 'Search here') this.value='';" onkeypress="" />
      <input type="submit" class="search c8" name="submit" value="Go"  />
   </div>
</form>
</div>
<div class="c10" id="svid12_6f43db4e123f11b409580004806"><div id="Printversion"><!-- Printversion --></div>

  <a class="breadcrumb" title="Printer friendly version" rel="nofollow" href="227.html.printable">

  Print |
</a></div>
<div class="c11"></div>
</div>
</div>
<div class="ielayoutfix c12"  id="svid10_6f43db4e123f11b409580004723">
<div id="svid94_6f43db4e123f11b40958000836" ><div id="svid10_6f43db4e123f11b409580003677">
<div class="c13" id="svid10_6f43db4e123f11b409580004666"><div class="c14" id="svid12_6f43db4e123f11b409580004536">
<div id="Expandingmenu"><!-- Expanding menu --></div><table summary="" cellspacing="1" cellpadding="0" class="c15">
<tr><td>
   <table summary="" class="c16">
 <tr>
  <td class="c17">
                  <img class="c18" alt="" src="../images/18.6f43db4e123f11b409580003636/navi-expand.gif" />
              </td>
   <td class="c15">
                        <a href="17.html" class="navigation" title="Community">Community</a>
           </td>
  </tr>
</table>
</td></tr>
<tr><td>
   <table summary="" class="c16">
 <tr>
  <td class="c17">
            </td>
   <td class="c15">
                        <a href="9.html" class="navigation" title="News">News</a>
           </td>
  </tr>
</table>
</td></tr>
<tr><td>
   <table summary="" class="c16">
 <tr>
  <td class="c17">
                  <img class="c18" alt="" src="../images/18.6f43db4e123f11b409580003636/navi-expand.gif" />
              </td>
   <td class="c15">
                        <a href="21.html" class="navigation" title="Licensing">Licensing</a>
           </td>
  </tr>
</table>
</td></tr>
<tr><td>
   <table summary="" class="c16">
 <tr>
  <td class="c17">
                  <img class="c18" alt="" src="../images/18.6f43db4e123f11b409580003636/navi-expand.gif" />
              </td>
   <td class="c15">
                        <a href="downloads.html" class="navigation" title="Download">Download</a>
           </td>
  </tr>
</table>
</td></tr>
<tr><td>
   <table summary="" class="c16">
 <tr>
  <td class="c17">
                  <img class="c18" alt="" src="../images/18.6f43db4e123f11b409580003636/navi-expand.gif" />
              </td>
   <td class="c15">
                        <a href="introduction.html" class="navigation" title="Introduction to Qi4j">Introduction to Qi4j</a>
           </td>
  </tr>
</table>
</td></tr>
<tr><td>
   <table summary="" class="c16">
 <tr>
  <td class="c17">
                  <img class="c18" alt="" src="../images/18.6f43db4e123f11b409580003636/navi-expand.gif" />
              </td>
   <td class="c15">
                        <a href="146.html" class="navigation" title="Tutorials &amp; HowTOs">Tutorials &amp; HowTOs</a>
           </td>
  </tr>
</table>
</td></tr>
<tr><td>
   <table summary="" class="c16">
 <tr>
  <td class="c17">
                  <img class="c18" alt="" src="../images/18.6f43db4e123f11b409580003636/navi-expand.gif" />
              </td>
   <td class="c15">
                        <a href="15.html" class="navigation" title="Documentation">Documentation</a>
           </td>
  </tr>
</table>
</td></tr>
<tr><td>
   <table summary="" class="c16">
 <tr>
  <td class="c17">
                  <img class="c18" alt="" src="../images/18.6f43db4e123f11b409580003861/navi-expand-no.gif" />
              </td>
   <td class="c15">
                        <a href="333.html" class="navigation" title="Sandbox">Sandbox</a>
           </td>
  </tr>
</table>
</td></tr>
<tr><td>
   <table summary="" class="c49">
 <tr>
  <td class="c50">
                  <img class="c18" alt="" src="../images/18.6f43db4e123f11b409580003636/navi-expand.gif" />
              </td>
   <td class="c15">
                        <a href="335.html" class="newsxmm" title="Extensions">Extensions</a>
           </td>
  </tr>
</table>
</td></tr>
<tr><td>
   <table summary="" class="c49">
 <tr>
  <td class="c50">
                  <img class="c18" alt="" src="../images/18.6f43db4e123f11b409580003861/navi-expand-no.gif" />
              </td>
   <td class="c15">
                        <a href="334.html" class="newsxmm" title="Libraries">Libraries</a>
           </td>
  </tr>
</table>
</td></tr>
<tr><td>
   <table summary="" class="c49">
 <tr>
  <td class="c55">
                  <img class="c18" alt="" src="../images/18.6f43db4e123f11b409580003636/navi-expand.gif" />
              </td>
   <td class="c15">
                        <a href="224.html" class="newsxmm" title="Beans">Beans</a>
           </td>
  </tr>
</table>
</td></tr>
<tr><td>
   <table summary="" class="c49">
 <tr>
  <td class="c55">
            </td>
   <td class="c15">
                        <a href="231.html" class="newsxmm" title="Exception">Exception</a>
           </td>
  </tr>
</table>
</td></tr>
<tr><td>
   <table summary="" class="c49">
 <tr>
  <td class="c55">
            </td>
   <td class="c15">
                        <a href="232.html" class="newsxmm" title="Executor">Executor</a>
           </td>
  </tr>
</table>
</td></tr>
<tr><td>
   <table summary="" class="c49">
 <tr>
  <td class="c55">
            </td>
   <td class="c15">
                        <a href="235.html" class="newsxmm" title="Registry">Registry</a>
           </td>
  </tr>
</table>
</td></tr>
<tr><td>
   <table summary="" class="c49">
 <tr>
  <td class="c55">
            </td>
   <td class="c15">
                        <a href="236.html" class="newsxmm" title="RMI">RMI</a>
           </td>
  </tr>
</table>
</td></tr>
<tr><td>
   <table summary="" class="c49">
 <tr>
  <td class="c55">
            </td>
   <td class="c15">
                        <a href="237.html" class="newsxmm" title="Thread">Thread</a>
           </td>
  </tr>
</table>
</td></tr>
<tr><td>
   <table summary="" class="c49">
 <tr>
  <td class="c55">
            </td>
   <td class="c15">
                        <a href="227.html" class="navigationxxactivex" title="UnitOfWork">UnitOfWork</a>
           </td>
  </tr>
</table>
</td></tr>
<tr><td>
   <table summary="" class="c49">
 <tr>
  <td class="c55">
            </td>
   <td class="c15">
                        <a href="238.html" class="newsxmm" title="Validation">Validation</a>
           </td>
  </tr>
</table>
</td></tr>
<tr><td>
   <table summary="" class="c16">
 <tr>
  <td class="c17">
            </td>
   <td class="c15">
                        <a href="336.html" class="navigation" title="Samples">Samples</a>
           </td>
  </tr>
</table>
</td></tr>
<tr><td>
   <table summary="" class="c16">
 <tr>
  <td class="c17">
                  <img class="c18" alt="" src="../images/18.6f43db4e123f11b409580003636/navi-expand.gif" />
              </td>
   <td class="c15">
                        <a href="sponsors.html" class="navigation" title="Sponsors">Sponsors</a>
           </td>
  </tr>
</table>
</td></tr>
<tr><td>
   <table summary="" class="c16">
 <tr>
  <td class="c17">
            </td>
   <td class="c15">
                        <a href="support.html" class="navigation" title="Support">Support</a>
           </td>
  </tr>
</table>
</td></tr>
<tr><td>
   <table summary="" class="c16">
 <tr>
  <td class="c17">
            </td>
   <td class="c15">
                        <a href="288.html" class="navigation" title="Latest Changes">Latest Changes</a>
           </td>
  </tr>
</table>
</td></tr>

</table>
</div>
<div class="c20" id="svid12_6f43db4e123f11b409580004771">
<div id="Text"><!-- Text --></div></div>
<div class="c29" id="svid12_58e87b6312cf378e76d8000904">
<div id="HTML"><!-- HTML --></div>


</div>
</div>
<div class="c5" id="svid10_6f43db4e123f11b409580004744"><div id="svid94_6f43db4e123f11b40958000912" ><div class="c53" id="svid10_6f43db4e123f11b409580004222">
<!-- Page content starts here --><div class="pagecontent" id="svid94_6f43db4e123f11b409580001419" ><div id="Centercolumn"><!-- Center column --></div><div class="c32" id="svid12_6f43db4e123f11b409580003312">
<div id="Heading"><!-- Heading --></div><div id="h-UnitOfWorkLibrary" class="sv-inline"><!-- UnitOfWork Library --></div><h1 class="heading">UnitOfWork Library</h1></div>
<div class="c52"></div>
<div id="svid12_6f43db4e123f11b409580003545">
<div id="Proxy"><!-- Proxy --></div><div xmlns="http://www.w3.org/1999/xhtml" xmlns:qi4j="http://www.qi4j.org/schemas/2008/dev-status/1" class="module-status">
    <div class="status-alpha" title="Code in early stage">
      code
    </div>
    
    <div class="status-alpha" title="Documentation is Brief">
      docs
    </div>
    
    <div class="status-alpha" title="Some Unittests">
      tests
    </div>
    
  </div>
</div>
<div class="c52"></div>
<div id="svid12_6f43db4e123f11b409580003966">
<div id="Proxy1"><!-- Proxy 1 --></div><project xmlns:xsi="urn:x-prefix:xsi" xsi:schemalocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  
<modelVersion>4.0.0</modelVersion>
  
<parent>
    
<groupId>org.qi4j</groupId>
    
<artifactId>qi4j-library</artifactId>
    
<version>0.7</version>
  
</parent>
  
<groupId>org.qi4j.library</groupId>
  
<artifactId>qi4j-lib-unitofwork</artifactId>
  
<name>Qi4j Library - UnitOfWork</name>
  
<version>0.8-SNAPSHOT</version>
  
<dependencies>
    
<dependency>
      
<groupId>org.qi4j.core</groupId>
      
<artifactId>qi4j-core-api</artifactId>
    
</dependency>
    
<dependency>
      
<groupId>junit</groupId>
      
<artifactId>junit</artifactId>
    
</dependency>
  
</dependencies>

</project>
</div>
<div class="c52"></div>
<div id="svid12_6f43db4e123f11b409580003739">
<div id="Content"><!-- Content --></div><div id="h-DeclarativeUnitOfWorkManagementSupport" class="sv-inline"><!-- Declarative UnitOfWork Management Support --></div><h2 class="subheading">Declarative UnitOfWork Management Support</h2><br /><span class="normal">This library allows you to use a declarative approach for management of the </span><span class="javaxcode">UnitOfWork</span><span class="normal"> creation, completion and discarding.</span><p><span class="normal">Instead of manually creating, completing and discarding </span><span class="javaxcode">UnitOfWork</span><span class="normal">, it is possible to declare </span><span class="javaxcode">@UnitOfWorkPropagation</span><span class="normal"> on methods, describing the requirements of </span><span class="javaxcode">UnitOfWork</span><span class="normal"> management at that method entry and exit.</span></p><p><span class="normal">For instance;</span></p></div>
<div class="c52"></div>
<div class="c73" id="svid12_6f43db4e123f11b409580003047">
<div id="Text-0"><!-- Text --></div><span class="javaxcode">@UnitOfPropagation( UnitOfPropagation.Propagation.REQUIRES_NEW )</span><br /><span class="javaxcode">public Location createLocation( "HKG", "Hong Kong" )</span><br /><span class="javaxcode">{</span><br /><span class="javaxcode">&nbsp;&nbsp;&nbsp;&nbsp;:</span><br /><span class="javaxcode">}</span></div>
<div class="c52"></div>
<div id="svid12_6f43db4e123f11b409580004180">
<div id="Text1"><!-- Text 1 --></div><span class="normal">In the above case the following things will happen;</span><ul><li><span class="normal">On method entry, a new non-nested UnitOfWork is created.</span></li><li><span class="normal">On method exit, the UnitOfWork is completed unless an Exception is thrown in which case it is discarded.</span></li></ul><p><span class="normal">For this to work, you need to include the UnitOfWorkConcern on the composite where you want this support to be available.</span></p></div>
<div class="c52"></div>
<div class="c73" id="svid12_6f43db4e123f11b409580004442">
<div id="Text2"><!-- Text 2 --></div><span class="javaxcode">@Concerns( { UnitOfWorkConcern.class } )</span><br /><span class="javaxcode">public interface MyExcellentService extends MyExcellent, ServiceComposite</span><br /><span class="javaxcode">{}</span></div>
<div class="c52"></div>
<div id="svid12_6f43db4e123f11b409580003757">
<div id="Text3"><!-- Text 3 --></div><span class="normal">The values available for the </span><span class="javaxcode">@UnitOfWorkPropagation</span><span class="normal"> are;</span><ul><li><span class="normal"></span><span class="javaxcode"><strong>REQUIRED</strong></span><span class="normal">, if a </span><span class="javaxcode">UnitOfWork</span><span class="normal"> is already in-progress it will be used, otherwise a new one is created. If one is created, then it will either be completed or discarded on method exit, but if one was already used, the method exit does nothing. This is the default value.</span></li><li><span class="normal"></span><span class="javaxcode"><strong>MANDATORY</strong></span><span class="normal">, if a </span><span class="javaxcode">UnitOfWork</span><span class="normal"> is not in-progress, then a </span><span class="javaxcode">UnitOfWorkPropagationException</span><span class="normal"> will be thrown, otherwise the method will proceed normally. No processing on method exit.</span></li><li><span class="normal"></span><span class="javaxcode"><strong>REQUIRES_NEW</strong></span><span class="normal">, a new </span><span class="javaxcode">UnitOfWork</span><span class="normal"> will be created, and upon method exit it will be completed or discarded.</span></li><li><span class="normal"></span><span class="javaxcode"><strong>REQUIRES_NESTED</strong></span><span class="normal">, if a </span><span class="javaxcode">UnitOfWork</span><span class="normal"> is in progress, then create a nested UnitOfWork, otherwise create a new UnitOfWork. On method exit, complete or discard the UnitOfWork created.</span></li><li><span class="normal"></span><span class="javaxcode"><strong>null</strong></span><span class="normal">, a </span><span class="javaxcode">UnitOfWorkPropagationException</span><span class="normal"> is thrown.</span></li></ul><p><span class="normal">It is also possible to declare the Discard Policy with two annotations;</span></p><ul><li><span class="normal"></span><span class="javaxcode"><strong>@UnitOfWorkDiscardOn</strong></span><span class="normal">, whose value is an array of </span><span class="javaxcode">Throwable</span><span class="normal"> classes. If the thrown class is a subclass of any class in the array, then discard the </span><span class="javaxcode">UnitOfWork</span><span class="normal">.</span></li><li><span class="normal"></span><span class="javaxcode"><strong>@UnitOfWorkNoDiscardOn</strong></span><span class="normal">, whose value is an array of </span><span class="javaxcode">Throwable</span><span class="normal"> classes. If the thrown class is a subclass of any class in the array, then do NOT discard the </span><span class="javaxcode">UnitOfWork</span><span class="normal">.</span></li></ul><p><span class="normal">If both of those annotations are present, then the discard will only happen </span><span class="normal"><strong>iff</strong></span><span class="normal"> the thrown class is a subclass of any of the </span><span class="javaxcode">@UnitOfWorkDiscardOn</span><span class="normal"> classes and not present among the classes in the </span><span class="javaxcode">@UnitOfWorkNoDiscardOn</span><span class="normal"> classes.</span></p></div>
</div><!-- Page content stops here --></div>
</div></div>
<div class="c11"></div>
</div>
</div></div>
<div class="c44" id="svid10_6f43db4e123f11b409580004680">
<div class="c45" id="svid12_6f43db4e123f11b409580004800">
<div id="TrademarkNotice"><!-- Trademark Notice --></div><br /><span class="normal">Qi4j and the Qi4j logo are trademarks of Richard Öberg, Niclas Hedhman and the members of the Qi4j Core Team. See </span><a class="normal" title="Link to licensing." href="21.html">Qi4j licensing</a><span class="normal"> for more information.</span></div>
<div class="c46" id="svid12_6f43db4e123f11b409580004768">
<div id="Poweredby"><!-- Powered by --></div><span class="normal">Powered by </span><a class="normal" title="SiteVision official page (external link)" href="http://www.sitevision.se/">SiteVision<img alt="external link" src="../sitevision/util/images/externallink.png" class="c39" /></a><span class="normal">.</span></div>
<div class="c47" id="svid12_6f43db4e123f11b409580004801">
<div id="HTML-0"><!-- HTML --></div><script>
</script>
<script type="text/javascript">


</script>
</div>
</div>
</div>
</div>


  
 



   </body>
</html>